function c=Qua2Mat(q0,q1,q2,q3)
    c=zeros(3,3);
    n=sqrt(q0^2+q1^2+q2^2+q3^2);
    q0=q0/n;q1=q1/n;q2=q2/n;q3=q3/n;

    c(1,1)=q0^2+q1^2-q2^2-q3^2;
    c(1,2)=2*(q1*q2+q0*q3);
    c(1,3)=2*(q1*q3-q0*q2);
    c(2,1)=2*(q1*q2-q0*q3);
    c(2,2)=q0^2-q1^2+q2^2-q3^2;
    c(2,3)=2*(q2*q3+q0*q1);
    c(3,1)=2*(q1*q3+q0*q2);
    c(3,2)=2*(q2*q3-q0*q1);
    c(3,3)=q0^2-q1^2-q2^2+q3^2;
end